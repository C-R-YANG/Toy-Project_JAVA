<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Contents">
    <insert id="insertRegisterData" parameterType="kr.co.ch.bori.contents.dto.PlaceDto">
        INSERT INTO place (
            opt
          , title
          , category
          , post_code
          , main_address
          , sub_address
          , district
          , neighborhood
          , tel
          , start_time
          , end_time
          , close_day
          , parking
        )
        VALUES (
            #{opt}
          , #{title}
          , #{category}
          , #{postCode}
          , #{mainAddress}
          , #{subAddress}
          , #{district}
          , #{neighborhood}
          , #{tel}
          , #{startTime}
          , #{endTime}
          , #{closeDay}
          , #{parking}
        )
    </insert>

    <select id="getContentsList" parameterType="kr.co.ch.bori.contents.dto.ParamDto" resultType="kr.co.ch.bori.contents.dto.PlaceDto">
        SELECT
            T1.*
          , C1.cd_nm AS district_nm
            <if test="opt == 0 || opt == 2">
          , C2.cd_nm AS category_nm
            </if>
        FROM
            place T1
            LEFT JOIN cdmgr C1 ON ( C1.cd = 'district' AND C1.key_cd = T1.district )
            <if test="opt == 0">
                LEFT JOIN cdmgr C2 ON ( C2.cd = 'food' AND C2.key_cd = T1.category )
            </if>
            <if test="opt == 2">
                LEFT JOIN cdmgr C2 ON ( C2.cd = 'hospital' AND C2.key_cd = T1.category )
            </if>
        WHERE
            opt = #{opt}
    </select>
</mapper>